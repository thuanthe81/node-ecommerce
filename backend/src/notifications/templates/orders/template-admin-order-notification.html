<!DOCTYPE html>
<html lang="{{locale}}" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="color-scheme" content="light dark">
  <meta name="supported-color-schemes" content="light dark">
  <title>{{translations.subject}}</title>
  <style type="text/css">
    /* Modern Email Design System CSS */
    .email-body {
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      color: #2c3e50;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }

    .preheader {
      display: none;
      font-size: 1px;
      color: #fefefe;
      line-height: 1px;
      max-height: 0px;
      max-width: 0px;
      opacity: 0;
      overflow: hidden;
    }

    .skip-link {
      position: absolute;
      left: -9999px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .skip-link:focus {
      position: static;
      left: auto;
      width: auto;
      height: auto;
      overflow: visible;
      background: #2c3e50;
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 4px;
    }

    .email-wrapper {
      width: 100%;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      border-collapse: collapse;
    }

    .email-wrapper-cell {
      padding: 20px;
      vertical-align: top;
    }

    .email-container {
      max-width: 600px;
      margin: 0 auto;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      border-collapse: collapse;
    }

    .email-header {
      background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
      color: white;
      padding: 32px;
      text-align: center;
      border-radius: 8px 8px 0 0;
    }

    .email-content {
      padding: 32px;
      background-color: #ffffff;
    }

    .email-footer {
      background-color: #f8f9fa;
      padding: 24px 32px;
      text-align: center;
      border-radius: 0 0 8px 8px;
      border-top: 1px solid #ecf0f1;
    }

    .card-section {
      margin: 16px 0;
      border-radius: 8px;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Responsive styles */
    @media only screen and (max-width: 480px) {
      .email-wrapper-cell {
        padding: 10px !important;
      }

      .email-content {
        padding: 20px !important;
      }

      .email-header {
        padding: 20px !important;
      }

      .email-footer {
        padding: 16px 20px !important;
      }
    }

    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      .email-body {
        background-color: #121212 !important;
        color: #ffffff !important;
      }

      .email-container {
        background-color: #1e1e1e !important;
      }

      .email-content {
        background-color: #1e1e1e !important;
      }

      .card-section {
        background-color: #2d2d2d !important;
      }
    }
  </style>
</head>
<body class="email-body">
  <!-- Preheader text for email preview -->
  <div class="preheader" style="display: none; font-size: 1px; color: #fefefe; line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;" aria-hidden="true">
    {{translations.subject}}
  </div>

  <!-- Skip link for accessibility -->
  <a href="#main-content" class="skip-link" tabindex="1">
    {{translations.skipToContent}}
  </a>

  <!-- Main email wrapper -->
  <div role="document" aria-label="{{translations.emailLabel}}">
    <table class="email-wrapper" cellpadding="0" cellspacing="0" border="0" role="presentation" aria-hidden="true">
      <tr>
        <td class="email-wrapper-cell">
          <table class="email-container" cellpadding="0" cellspacing="0" border="0" role="presentation" aria-hidden="true">

            <!-- Email Header -->
            <tr>
              <td class="email-header" role="banner">
                {{{emailHeader}}}
              </td>
            </tr>

            <!-- Main Email Content -->
            <tr>
              <td class="email-content" role="main" id="main-content">

                <!-- Alert Header with Priority -->
                <div style="text-align: center; margin-bottom: 32px;">
                  <div style="
                    display: inline-block;
                    width: 64px;
                    height: 64px;
                    background: linear-gradient(135deg, #e74c3c 0%, #f39c12 100%);
                    border-radius: 50%;
                    margin-bottom: 16px;
                    position: relative;
                  ">
                    <div style="
                      position: absolute;
                      top: 50%;
                      left: 50%;
                      transform: translate(-50%, -50%);
                      color: white;
                      font-size: 24px;
                      font-weight: bold;
                    ">ðŸ””</div>
                  </div>
                  <h2 style="
                    color: #2c3e50;
                    margin: 0;
                    font-family: Georgia, Times New Roman, serif;
                    font-size: 24px;
                  ">{{translations.title}}</h2>

                  <!-- Priority Badge -->
                  {{#if (gt data.total 1000000)}}
                    <div style="
                      display: inline-block;
                      padding: 4px 16px;
                      background-color: #e74c3c;
                      color: white;
                      border-radius: 12px;
                      font-size: 12px;
                      font-weight: 600;
                      text-transform: uppercase;
                      letter-spacing: 0.5px;
                      margin-top: 8px;
                    ">{{translations.urgent}}</div>
                  {{else}}
                    <div style="
                      display: inline-block;
                      padding: 4px 16px;
                      background-color: #27ae60;
                      color: white;
                      border-radius: 12px;
                      font-size: 12px;
                      font-weight: 600;
                      text-transform: uppercase;
                      letter-spacing: 0.5px;
                      margin-top: 8px;
                    ">{{translations.normal}}</div>
                  {{/if}}
                </div>

                <!-- Order Details Card -->
                <div class="card-section" style="
                  background-color: #ffffff;
                  padding: 24px;
                  margin: 16px 0;
                  border-radius: 8px;
                  border-left: 4px solid #3498db;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                ">
                  <h3 style="
                    margin-top: 0;
                    color: #2c3e50;
                    font-family: Georgia, Times New Roman, serif;
                  ">{{translations.orderDetails}}</h3>

                  <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                        width: 30%;
                      ">{{translations.orderNumber}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                        font-weight: 600;
                      ">#{{data.orderNumber}}</td>
                    </tr>
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                      ">{{translations.orderDate}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                      ">{{formatDate data.orderDate locale}}</td>
                    </tr>
                  </table>
                </div>

                <!-- Customer Information Card -->
                <div class="card-section" style="
                  background-color: #ffffff;
                  padding: 24px;
                  margin: 16px 0;
                  border-radius: 8px;
                  border-left: 4px solid #3498db;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                ">
                  <h3 style="
                    margin-top: 0;
                    color: #2c3e50;
                    font-family: Georgia, Times New Roman, serif;
                  ">{{translations.customerInfo}}</h3>

                  <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                        width: 30%;
                      ">{{translations.name}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                        font-weight: 600;
                      ">{{data.customerName}}</td>
                    </tr>
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                      ">{{translations.email}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                      ">{{data.customerEmail}}</td>
                    </tr>
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                      ">{{translations.phone}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                      ">{{data.customerPhone}}</td>
                    </tr>
                  </table>
                </div>

                <!-- Order Items Section -->
                <h3 style="
                  color: #2c3e50;
                  font-family: Georgia, Times New Roman, serif;
                  font-size: 20px;
                  margin: 32px 0 24px 0;
                ">{{translations.items}}</h3>

                <!-- Product Items Table -->
                <table class="items-table" style="
                  width: 100%;
                  margin: 24px 0;
                  border-radius: 8px;
                  overflow: hidden;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                ">
                  <thead>
                    <tr>
                      <th style="
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        color: #ffffff;
                        padding: 16px;
                        text-align: left;
                        font-weight: 600;
                      ">{{translations.product}}</th>
                      <th style="
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        color: #ffffff;
                        padding: 16px;
                        text-align: left;
                        font-weight: 600;
                      ">{{translations.sku}}</th>
                      <th style="
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        color: #ffffff;
                        padding: 16px;
                        text-align: center;
                        font-weight: 600;
                      ">{{translations.quantity}}</th>
                      <th style="
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        color: #ffffff;
                        padding: 16px;
                        text-align: right;
                        font-weight: 600;
                      ">{{translations.price}}</th>
                      <th style="
                        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                        color: #ffffff;
                        padding: 16px;
                        text-align: right;
                        font-weight: 600;
                      ">{{translations.total}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    {{#each data.items}}
                    <tr>
                      <td style="
                        padding: 16px;
                        border-bottom: 1px solid #ecf0f1;
                        background-color: {{#if @even}}#f8f9fa{{else}}#ffffff{{/if}};
                      ">{{#if (eq ../locale 'vi')}}{{this.nameVi}}{{else}}{{this.nameEn}}{{/if}}</td>
                      <td style="
                        padding: 16px;
                        border-bottom: 1px solid #ecf0f1;
                        background-color: {{#if @even}}#f8f9fa{{else}}#ffffff{{/if}};
                        font-family: monospace;
                        font-size: 12px;
                      ">{{this.sku}}</td>
                      <td style="
                        padding: 16px;
                        border-bottom: 1px solid #ecf0f1;
                        background-color: {{#if @even}}#f8f9fa{{else}}#ffffff{{/if}};
                        text-align: center;
                      ">{{this.quantity}}</td>
                      <td style="
                        padding: 16px;
                        border-bottom: 1px solid #ecf0f1;
                        background-color: {{#if @even}}#f8f9fa{{else}}#ffffff{{/if}};
                        text-align: right;
                      ">{{formatCurrency this.price ../locale}}</td>
                      <td style="
                        padding: 16px;
                        border-bottom: 1px solid #ecf0f1;
                        background-color: {{#if @even}}#f8f9fa{{else}}#ffffff{{/if}};
                        text-align: right;
                        font-weight: 600;
                      ">{{formatCurrency this.total ../locale}}</td>
                    </tr>
                    {{/each}}
                  </tbody>
                </table>

                <!-- Order Summary -->
                <div style="margin: 32px 0;">
                  <table class="items-table" style="
                    width: 100%;
                    margin: 24px 0;
                    border-radius: 8px;
                    overflow: hidden;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                  ">
                    <thead>
                      <tr>
                        <th style="
                          background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                          color: #ffffff;
                          padding: 16px;
                          text-align: left;
                          font-weight: 600;
                        " colspan="2">{{translations.orderDetails}}</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #ffffff;
                        ">{{translations.subtotal}}</td>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #ffffff;
                          text-align: right;
                        ">{{formatCurrency data.subtotal locale}}</td>
                      </tr>
                      <tr>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #f8f9fa;
                        ">{{translations.shipping}} ({{data.shippingMethod}})</td>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #f8f9fa;
                          text-align: right;
                        ">{{formatCurrency data.shippingCost locale}}</td>
                      </tr>
                      {{#if (gt data.taxAmount 0)}}
                      <tr>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #ffffff;
                        ">{{translations.tax}}</td>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #ffffff;
                          text-align: right;
                        ">{{formatCurrency data.taxAmount locale}}</td>
                      </tr>
                      {{/if}}
                      {{#if (gt data.discountAmount 0)}}
                      <tr>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #f8f9fa;
                        ">{{translations.discount}}</td>
                        <td style="
                          padding: 16px;
                          border-bottom: 1px solid #ecf0f1;
                          background-color: #f8f9fa;
                          text-align: right;
                        ">-{{formatCurrency data.discountAmount locale}}</td>
                      </tr>
                      {{/if}}
                      <tr class="total-row">
                        <td style="
                          font-weight: 600;
                          font-size: 16px;
                          background-color: #f8f9fa !important;
                          border-top: 2px solid #2c3e50;
                          padding: 16px;
                        "><strong>{{translations.grandTotal}}</strong></td>
                        <td style="
                          font-weight: 600;
                          font-size: 16px;
                          background-color: #f8f9fa !important;
                          border-top: 2px solid #2c3e50;
                          padding: 16px;
                          text-align: right;
                        "><strong>{{formatCurrency data.total locale}}</strong></td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Shipping Address -->
                <div style="margin: 32px 0;">
                  {{{generateAddressCard data.shippingAddress translations.shippingAddress locale}}}
                </div>

                <!-- Billing Address -->
                <div style="margin: 32px 0;">
                  {{{generateAddressCard data.billingAddress translations.billingAddress locale}}}
                </div>

                <!-- Payment Information -->
                <div class="card-section" style="
                  background-color: #ffffff;
                  padding: 24px;
                  margin: 16px 0;
                  border-radius: 8px;
                  border-left: 4px solid #3498db;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                ">
                  <h3 style="
                    margin-top: 0;
                    color: #2c3e50;
                    font-family: Georgia, Times New Roman, serif;
                  ">{{translations.paymentInfo}}</h3>

                  <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                        width: 30%;
                      ">{{translations.paymentMethod}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                      ">{{data.paymentMethod}}</td>
                    </tr>
                    <tr>
                      <td style="
                        padding: 8px 0;
                        font-weight: 600;
                        color: #7f8c8d;
                      ">{{translations.paymentStatus}}:</td>
                      <td style="
                        padding: 8px 0;
                        color: #2c3e50;
                      ">{{{generateStatusBadge data.paymentStatus locale}}}</td>
                    </tr>
                  </table>
                </div>

                <!-- Customer Notes (if any) -->
                {{#if data.notes}}
                <div class="card-section" style="
                  background-color: #ffffff;
                  padding: 24px;
                  margin: 16px 0;
                  border-radius: 8px;
                  border-left: 4px solid #f39c12;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                ">
                  <h3 style="
                    margin-top: 0;
                    color: #f39c12;
                    font-family: Georgia, Times New Roman, serif;
                  ">{{translations.customerNotes}}</h3>
                  <p style="
                    margin: 0;
                    color: #2c3e50;
                    font-style: italic;
                  ">{{data.notes}}</p>
                </div>
                {{/if}}

                <!-- Call-to-Action Buttons -->
                <div style="
                  text-align: center;
                  margin: 48px 0;
                  padding: 32px 0;
                  border-top: 1px solid #ecf0f1;
                  border-bottom: 1px solid #ecf0f1;
                ">
                  <div style="margin-bottom: 16px;">
                    {{{generateButton translations.viewOrder (concat adminUrl "/orders/" data.orderNumber) "primary"}}}
                  </div>
                  <div>
                    {{{generateButton translations.processOrder (concat adminUrl "/orders/" data.orderNumber "/process") "secondary"}}}
                  </div>
                </div>

              </td>
            </tr>

            <!-- Email Footer -->
            <tr>
              <td class="email-footer" role="contentinfo">
                {{{emailFooter}}}
              </td>
            </tr>

          </table>
        </td>
      </tr>
    </table>
  </div>

  <!-- Screen reader announcements -->
  <div aria-live="polite" aria-atomic="true" class="sr-only" id="announcements"></div>
</body>
</html>