<!DOCTYPE html>
<html lang="{{locale}}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{translations.subject}}</title>
  <style>
    {{{designSystemCSS}}}
  </style>
</head>
<body style="
  font-family: Arial, sans-serif;
  line-height: 1.6;
  color: #333;
  max-width:
  600px; margin: 0 20px;
  padding: 20px;
  background-color: #ffffff;">
  <table style="width: 100%; max-width:600px">
    <tbody>
    <tr>
      <td>
        <!-- Preheader text for email preview -->
        <div class="preheader" style="display: none; font-size: 1px; color: #fefefe; line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;" aria-hidden="true">
          {{translations.subject}}
        </div>

        {{> email-header companyName=(companyName locale) tagline=translations.tagline}}

        <!-- Status Update Header -->
        <div style="text-align: center; margin-bottom: 32px;">
          <div style="
            display: inline-block;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            border-radius: 50%;
            margin-bottom: 16px;
            position: relative;
            ">
            <div style="
              color: white;
              font-size: 24px;
              font-weight: bold;
              margin-top: 10px;
              ">üìã</div>
          </div>
          <h2 style="
            color: #2c3e50;
            margin: 32px 0 8px 0;
            font-size: 18px;
            font-weight: 600;
            ">{{translations.title}}</h2>
        </div>

        <p style="font-size: 16px; margin-bottom: 15px;">{{translations.greeting}} {{data.customerName}},</p>

        <p style="font-size: 16px; margin-bottom: 20px;">{{translations.thankYou}}</p>

        <div style="
          background-color: #ffffff;
          padding: 24px;
          margin: 16px 0;
          border-radius: 8px;
          border-left: 4px solid #3498db;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      ">
          <h3 style="margin-top: 0; margin-bottom: 15px; color: #2c3e50; font-size: 18px;">{{translations.orderDetails}}</h3>
          <p style="margin: 8px 0; font-size: 14px;"><strong>{{translations.orderNumber}}:</strong> {{data.orderNumber}}</p>
          <p style="margin: 8px 0; font-size: 14px;"><strong>{{translations.orderDate}}:</strong> {{formatDate data.orderDate locale}}</p>

          <!-- Order Items and Total (if available) -->
          {{#if data.items}}
          <div style="background-color: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; margin-bottom: 15px; color: #2c3e50; font-size: 18px;">{{translations.orderItems}}</h3>

            <!-- Items Table -->
            <table style="width: 100%; border-collapse: collapse; margin-bottom: 16px;">
              <thead>
              <tr style="background-color: #e9ecef;">
                <th style="padding: 12px; text-align: left; font-weight: 600; color: #495057;">{{translations.product}}</th>
                <th style="padding: 12px; text-align: center; font-weight: 600; color: #495057;">{{translations.quantity}}</th>
                <th style="padding: 12px; text-align: right; font-weight: 600; color: #495057;">{{translations.price}}</th>
              </tr>
              </thead>
              <tbody>
              {{#each data.items}}
              <tr style="border-bottom: 1px solid #dee2e6;">
                <td style="padding: 12px; color: #2c3e50;">
                  {{#if (eq ../locale 'vi')}}
                    {{#if this.productNameVi}}{{this.productNameVi}}{{else}}{{this.name}}{{/if}}
                  {{else}}
                    {{#if this.productName}}{{this.productName}}{{else}}{{this.name}}{{/if}}
                  {{/if}}
                </td>
                <td style="padding: 12px; text-align: center; color: #2c3e50;">{{this.quantity}}</td>
                <td style="padding: 12px; text-align: right; color: #2c3e50;">{{formatCurrency this.price ../locale}} ‚Ç´</td>
              </tr>
              {{/each}}
              </tbody>
            </table>

            <!-- Order Total -->
            <div style="text-align: right; padding-top: 16px; border-top: 2px solid #2c3e50;">
              <p style="margin: 0; font-size: 18px; font-weight: 600; color: #2c3e50;">
                {{translations.total}}: {{safeCalculateTotal data.items locale}}
              </p>
            </div>

            <!-- Quote Items Message -->
            {{#if data.hasQuoteItems}}
            <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin-top: 16px;">
              <p style="margin: 0; color: #856404; font-size: 14px;">
                {{#if (eq locale 'vi')}}
                  ‚ÑπÔ∏è ƒê∆°n h√†ng c·ªßa b·∫°n c√≥ s·∫£n ph·∫©m c·∫ßn b√°o gi√°. Ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n ƒë·ªÉ x√°c nh·∫≠n gi√° cu·ªëi c√πng.
                {{else}}
                  ‚ÑπÔ∏è Your order contains items requiring quotes. We will contact you to confirm final pricing.
                {{/if}}
              </p>
            </div>
            {{/if}}

            <div style="margin-top: 20px; text-align: center;">
              {{> button text=translations.trackOrder url=(concat (frontendUrl) "/" locale "/orders/" data.orderId) style="primary"}}
            </div>
          </div>
          {{/if}}

        </div>
      </td>
    </tr>
    <tr>
      <td>
        <p style="font-size: 16px; margin: 20px 0;">{{translations.contactUs}}</p>
      </td>
    </tr>
    <tr>
      <td>
        {{> email-footer
            currentYear=currentYear
            companyName=(companyName locale)
            supportEmail=(supportEmail)
            websiteUrl=(frontendUrl)
            disclaimer=translations.disclaimer}}
      </td>
    </tr>
    </tbody>
  </table>
</body>
</html>